<!DOCTYPE html>

{$html_class_array = []}
{$_color_scheme_class = 'color_scheme_'|cat:str_replace('img/themesettings/','',str_replace('.png','',$theme_settings.color_scheme))}

{if $theme_settings.color_scheme}{$html_class_array[] = $_color_scheme_class}{/if}
{if $theme_settings.font_size}{$html_class_array[] = $theme_settings.font_size}{/if}
{if $theme_settings.font_family}{$html_class_array[] = $theme_settings.font_family}{/if}
{if $wa->globals('isMyAccount')}{$html_class_array[] = 'my'}{/if}

{$html_class = ""}
{if !empty($html_class_array)}
    {$html_class = "{join(' ', $html_class_array)}"}
{/if}
{if is_array($category)}
    {$cat_id = $category.id}
{elseif is_object($product)}
    {$cat = $wa->shop->category($product.category_id)}
    {$cat_id = $cat.id}
{/if}

{if $cat_id}
    {$cat_class = 'category_'|cat:$cat_id}
{/if}


<html class="{$html_class} {$cat_class}">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1{if $wa->isMobile()}, maximum-scale=1, user-scalable=0{/if}" />

    <title>{$wa->title()|escape}</title>
    {$meta = $wa->meta('keywords')|escape}
    {if $meta}
        <meta name="Keywords" content="{$meta}" />
    {/if}
    {$meta = $wa->meta('description')|escape}
    {if $meta}
        <meta name="Description" content="{$meta}" />
    {/if}

    {$currentUrl = $wa->currentUrl(true)}
    {if $currentUrl|strstr:'tags_' || $currentUrl|strstr:'category/'}
        {$split = '?'|explode:$currentUrl}
        {$canonical = $split[0]}
    {/if}

    {if !empty($canonical)}<link rel="canonical" href="{$canonical}"/>{/if}
    <link rel="shortcut icon" href="/favicon.ico"/>
    {if $wa->blog}
        <!-- rss -->
        {$rss=$wa->blog->rssUrl()}
        {if $rss}<link rel="alternate" type="application/rss+xml" title="{$wa->accountName()}" href="{$rss}">{/if}
    {/if}
       
    <!-- css -->
    <link href="{$wa_theme_url}default.css?v{$wa_theme_version}" rel="stylesheet" type="text/css"/>
    {if $wa->shop && $wa->shop->currency() == 'RUB'}<link href="{$wa_url}wa-content/font/ruble/arial/fontface.css" rel="stylesheet" type="text/css">{/if}
    {$wa->css()} {* links active plugins CSS *}
    
    <!-- js -->
    <script type="text/javascript" src="{$wa_static_url}wa-content/js/jquery/jquery-1.11.1.min.js" ></script>
    <script type="text/javascript" src="{$wa_static_url}wa-content/js/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="{$wa_theme_url}default.js?v{$wa_theme_version}"></script>

    {$wa->js()} {* links active plugins JS *}
    
    {include file="`$wa_active_theme_path`/head.html" inline}
    
    {$wa->head()} {* links Google Analytics tracking code, site's custom JS (defined in Site app settings), and meta data such as Open Graph data *}
    
    <!--[if lt IE 9]>
    <script>
    document.createElement('header');
    document.createElement('nav');
    document.createElement('section');
    document.createElement('article');
    document.createElement('aside');
    document.createElement('footer');
    document.createElement('figure');
    document.createElement('hgroup');
    document.createElement('menu');
    </script>
    <![endif]-->

</head>
<body>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter26711982 = new Ya.Metrika({
                    id:26711982,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true,
                    webvisor:true,
                    ecommerce:"dataLayer"
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
                s = d.createElement("script"),
                f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/26711982" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

    <aside class="aside">
        {include file="`$wa_active_theme_path`/sidebar.html" inline}
    </aside>
    <div class="content-bumper"></div>
    <div class="content-wrapper">

        {include file="`$wa_active_theme_path`/header.html"}


<!--
Диагностическая информация
        {if is_array($category)}
            CATEGORY:
            {$category|@print_r}
        {/if}
        {if is_array($collection)}
            COLLECTION:
            {$collection|@print_r}
        {/if}
        {if is_object($product) && false}
            PRODUCT:
            {$product|@print_r}
        {/if}
        {if is_array($page)}
            PAGE:
            {$page|@print_r}
        {/if}
-->

        <!-- APP CONTENT -->
        <main class="maincontent" role="main">
            <div class="container">

                {if $page && $page.mainish == "true"}
                    {$categories = $wa->shop->categories(0, null, true)}
                    <div class="pop">
                        {foreach $categories as $cat}
                        <div class="pop__cat pop__cat_{$cat.id}">
                            <a href="{$cat.url}" class="pop__cat-link pop__cat-link_{$cat.id}">{$cat.name|escape|upper}</a>
                        </div>
                        {/foreach}
                    </div>

                <!-- BESTSELLERS product list -->
                {$productSetName = $page.list}
                {$productSetTitle = $page.list_title}

                {if !$productSetName}
                    {$productSetName = "bestsellers"}
                {/if}

                {if !$productSetTitle}
                    {$productSetTitle = $page.title}
                {/if}

                {$products = $wa->shop->productSet("`$productSetName`")}
                {if $products}

                <section class="bestsellers">
                    <h5 class="bestsellers-header">{$productSetTitle|upper}</h5>
                {include file="list-thumbs.html" products=$products disable_compare=true mini=true}
                </section>
                <script type="text/javascript" src="{$wa_active_theme_url}equalizeProductName.js"></script>

                {else}
                <p class="hint align-center"><br><em>{sprintf('[`In your store backend, drag some products into <strong>%s</strong> product list (which is in the left sidebar of the Products screen), and these products will be automatically published here — right on your storefront homepage.`]', $theme_settings.homepage_productset_bestsellers|escape|default:'()' )}</em></p>
                {/if}

                    <div class="maintext">
                        {$content}
                    </div>
                {else}
                    {$content}
                {/if}
            </div>

        </main>
    </div>


    {include file="`$wa_active_theme_path`/footer.html"}
    
    {* admin-only slideout sidebar for nice and smooth real time theme customizations *}
    {* if $wa->user()->isAdmin()}{include file="admin-sidebar.html" inline *}{* /if *}

</body>
</html>
